import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{c as T}from"./sampledata-dqDZKv4N.js";import{l as I,b as D}from"./utils-Cq-m8ugv.js";import{J}from"./jszip.min-CqN8Epyx.js";import{r as t,R as G}from"./index-iNOV5qWA.js";import{S as O,a as P}from"./synthesis-C19dj4Rf.js";import{U as Z}from"./Ust-B05cA2Ng.js";import{V as H}from"./VoiceBank-C9vet1UG.js";import{u as K}from"./musicProjectStore-BsvuTYmn.js";import"./resampWorker-BBgBVPde.js";import"./Logging-BGLwk1OE.js";import"./interp-BFp6dTGs.js";import"./cookieStore-BsTWuq-c.js";import"./note-PQ4Q7K1Q.js";import"./react-D0diZGQB.js";import"./readTextFile-BNLodD0O.js";import"./Note-CcnmOUAw.js";import"./Notenum-DIq-GRnt.js";import"./extractFileFromZip-BLIorQxg.js";const l=({vbFileName:g,ustBuffer:E,testDescription:k})=>{const{vb:d,setVb:u,ust:Q,setUst:p}=K(),[X,U]=t.useState(null),[v,W]=t.useState(!0),[f,h]=t.useState(null),[y,C]=t.useState(void 0),[n,L]=t.useState(null),[a,F]=t.useState(null),[S,N]=t.useState(null),[o,R]=t.useState(null),[m,_]=t.useState(null),[c,z]=t.useState(null),M=G.useMemo(()=>new O,[]);return t.useEffect(()=>{(async()=>{try{const s=new TextDecoder("Shift-JIS"),i=new Z;await i.load(E),p(i),R(Date.now());const x=await I(g);_(Date.now());const j=new J;await j.loadAsync(x,{decodeFileName:q=>s.decode(q)});const V=new H(j.files);await V.initialize(),u(V),z(Date.now()),N(x.byteLength/1048576)}catch(s){h(s instanceof Error?s.message:String(s))}})()},[u,p]),t.useEffect(()=>{if(!d)return;(async()=>{try{L(Date.now());const s=await M.synthesis([]);F(Date.now()),U(s);const i=URL.createObjectURL(new Blob([s],{type:"audio/wav"}));C(i)}catch(s){h(s instanceof Error?s.message:String(s))}finally{W(!1)}})()},[d]),e.jsxs("div",{style:{padding:"1rem",fontFamily:"Arial, sans-serif"},children:[e.jsx("h2",{children:"Synthesis Worker Demo"}),e.jsxs("p",{children:["このコンポーネントはSynthesisWorker.synthesis()をテストするためのものです。",e.jsx("br",{}),"このテストシナリオでは、",k]}),e.jsx("h2",{children:"VBの概要"}),S&&e.jsxs("p",{children:["ロードしたVB: ",S," MB"]}),o&&e.jsxs("p",{children:["開始時刻: ",o," ms"]}),m&&e.jsxs("p",{children:["完了時刻: ",m," ms（VBのフェッチにかかった時間:"," ",m-o," ms）"]}),c&&e.jsxs("p",{children:["完了時刻: ",c," ms（VBのロードにかかった時間:"," ",c-o," ms）"]}),e.jsx("h2",{children:"合成処理"}),e.jsxs("p",{children:["workerの数:",P]}),n&&e.jsxs("p",{children:["開始時刻: ",n," ms"]}),a&&e.jsxs("p",{children:["完了時刻: ",a," ms（合成にかかった時間: ",a-n," ms）"]}),v&&e.jsx("p",{children:"Processing..."}),f&&e.jsxs("p",{style:{color:"red"},children:["Error: ",f]}),y!==void 0&&e.jsx("audio",{src:y,controls:!0})]})};l.__docgenInfo={description:"",methods:[],displayName:"SynthesisWorkerDemo",props:{vbFileName:{required:!0,tsType:{name:"string"},description:""},ustBuffer:{required:!0,tsType:{name:"ArrayBuffer"},description:""},testDescription:{required:!0,tsType:{name:"string"},description:""}}};D(T);const Se={title:"90_Workerテスト/synthテスト",component:l},r=()=>e.jsx(l,{vbFileName:"minimumCV.zip",ustBuffer:D(T),testDescription:"休符が2つ、音符が7つの短い音声を合成します。"});r.storyName="単独音で短いustを合成する時間の測定";r.__docgenInfo={description:"",methods:[],displayName:"MinimumCV"};var b,w,B;r.parameters={...r.parameters,docs:{...(b=r.parameters)==null?void 0:b.docs,source:{originalSource:'() => <SynthesisWorkerDemo vbFileName="minimumCV.zip" ustBuffer={base64ToArrayBuffer(sampleShortCVUst)} testDescription="休符が2つ、音符が7つの短い音声を合成します。" />',...(B=(w=r.parameters)==null?void 0:w.docs)==null?void 0:B.source}}};const xe=["MinimumCV"];export{r as MinimumCV,xe as __namedExportsOrder,Se as default};
