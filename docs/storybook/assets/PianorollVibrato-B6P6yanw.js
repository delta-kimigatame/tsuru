import{j as r}from"./jsx-runtime-D_zvdyIk.js";import{C as L,P as u}from"./PianorollBackground-CeWu-PaL.js";import{u as v}from"./useThemeMode-DBwfopSL.js";import{L as b}from"./Logging-BGLwk1OE.js";import{u as E}from"./cookieStore-BsTWuq-c.js";import{u as _}from"./musicProjectStore-BsvuTYmn.js";import{m as j}from"./interp-BFp6dTGs.js";import{m as I,d as O,n as V}from"./PianorollPitch-Ss1AkXxq.js";const N=c=>{const{colorTheme:f,verticalZoom:d,horizontalZoom:n}=E(),{notes:x}=_(),P=v(),y=(e,o,h,g)=>{if(e.vibrato===void 0){b.warn("vibratoが存在しないノートは処理しないはずなのに描画処理が呼ばれた。","PianorollVibrato");return}const T=j(e.pitchSpan,0,e.targetLength/1e3),A=e.getVibratoPitches(e,T,0),a=T.map(t=>I(t*1e3,e.tempo,g)),m=A.map(t=>O(t/10,h));if(a.length!==m.length){b.warn("xAxisとyValuesの数が合わない。何かがおかしい","PianorollVibrato");return}const i=[],l=V(e.notenum,h);let p=!1;return m.forEach((t,s)=>{!p&&t===0||(p||(p=!0,s===0?i.push(`${o},${l}`):i.push(`${o+a[s-1]},${l+m[s-1]}`)),i.push(`${o+a[s]},${l+t}`))}),i.join(" ")};return r.jsx(r.Fragment,{children:r.jsx("svg",{width:c.totalLength*u.NOTES_WIDTH_RATE*n,height:u.TOTAL_HEIGHT*d,style:{pointerEvents:"none",display:"block",position:"absolute",top:0,left:0,zIndex:3},children:x.map((e,o)=>r.jsx(r.Fragment,{children:e.lyric!=="R"&&e.vibrato!==void 0&&r.jsx("polyline",{points:y(e,c.notesLeft[o]*u.NOTES_WIDTH_RATE*n,d,n),stroke:L[f][P].pitch,fill:"none"},o)}))})})};N.__docgenInfo={description:"",methods:[],displayName:"PianorollVibrato",props:{selectedNotesIndex:{required:!0,tsType:{name:"Array",elements:[{name:"number"}],raw:"Array<number>"},description:""},notesLeft:{required:!0,tsType:{name:"Array",elements:[{name:"number"}],raw:"Array<number>"},description:""},totalLength:{required:!0,tsType:{name:"number"},description:""}}};export{N as P};
