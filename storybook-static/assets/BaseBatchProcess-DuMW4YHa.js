var u=Object.defineProperty;var c=(e,t,s)=>t in e?u(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var r=(e,t,s)=>c(e,typeof t!="symbol"?t+"":t,s);import{L as o,a as n}from"./Logging-BGLwk1OE.js";class h{constructor(){r(this,"_undoStack");r(this,"_redoStack");r(this,"register",t=>{o.info(`undostackの追加:${t.summary}`,"UndoManager"),this._undoStack.push(t),this._redoStack=[]});r(this,"undo",()=>{if(this._undoStack.length===0){o.warn("undostackが空です","UndoManager");return}const t=this._undoStack.pop();return this._redoStack.push(t),o.info(`undoの実行:${t.summary}、args:${t.undoArgs}`,"UndoManager"),t.undo(t.undoArgs)});r(this,"redo",()=>{if(this._redoStack.length===0){o.warn("redostackが空です","UndoManager");return}const t=this._redoStack.pop();return this._undoStack.push(t),o.info(`redoの実行:${t.summary}、${t.redoArgs}`,"UndoManager"),t.redo(t.redoArgs)});o.debug("UndoManagerの初期化","UndoManager"),this._undoStack=[],this._redoStack=[]}get undoSummary(){if(this._undoStack.length!==0)return this._undoStack.slice(-1)[0].summary}get redoSummary(){if(this._redoStack.length!==0)return this._redoStack.slice(-1)[0].summary}clear(){o.debug("undostackの消去","UndoManager"),this._undoStack=[],this._redoStack=[]}}const g=new h;class S{constructor(){r(this,"undo",t=>t);r(this,"redo",t=>this._process(t.notes,t.options));r(this,"log",(t,s)=>{switch(s){case n.DEBUG:o.debug(t,this.title);break;case n.INFO:o.info(t,this.title);break;case n.WARN:o.warn(t,this.title);break;case n.ERROR:o.error(t,this.title);break}});r(this,"ui",[]);r(this,"initialOptions");this.process=this.process.bind(this)}process(t,s){if(t.length===0)return[];const a=t.map(i=>i.deepCopy());this.log(`${this.summary}、options:${JSON.stringify(s)}`,n.INFO);const d=this._process(t,s);return g.register({undo:this.undo,undoArgs:a,redo:this.redo,redoArgs:{notes:a,options:s},summary:this.summary}),d}}export{S as B};
